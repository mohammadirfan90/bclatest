{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///home/mohammadirfan/bclatest/src/lib/auth-context.tsx"],"sourcesContent":["'use client';\n\nimport { createContext, useContext, useState, useEffect, ReactNode } from 'react';\nimport { useRouter } from 'next/navigation';\n\n// =============================================================================\n// Types\n// =============================================================================\n\ninterface User {\n    id: number;\n    email: string;\n    firstName: string;\n    lastName: string;\n    roleCode?: string;\n    roleName?: string;\n    permissions?: string[];\n    customerNumber?: string;\n    kycStatus?: string;\n}\n\ninterface AuthContextType {\n    user: User | null;\n    token: string | null;\n    isLoading: boolean;\n    isAuthenticated: boolean;\n    userType: 'user' | 'customer' | null;\n    login: (email: string, password: string, type: 'user' | 'customer') => Promise<{ success: boolean; error?: string }>;\n    logout: () => void;\n    hasPermission: (permission: string) => boolean;\n    isRole: (role: string) => boolean;\n}\n\n// =============================================================================\n// Context\n// =============================================================================\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\n\n// =============================================================================\n// Provider\n// =============================================================================\n\nexport function AuthProvider({ children }: { children: ReactNode }) {\n    const [user, setUser] = useState<User | null>(null);\n    const [token, setToken] = useState<string | null>(null);\n    const [userType, setUserType] = useState<'user' | 'customer' | null>(null);\n    const [isLoading, setIsLoading] = useState(true);\n    const router = useRouter();\n\n    // Load auth state from localStorage on mount\n    useEffect(() => {\n        const storedToken = localStorage.getItem('token');\n        const storedUser = localStorage.getItem('user');\n        const storedUserType = localStorage.getItem('userType') as 'user' | 'customer' | null;\n\n        if (storedToken && storedUser) {\n            setToken(storedToken);\n            setUser(JSON.parse(storedUser));\n            setUserType(storedUserType);\n        }\n        setIsLoading(false);\n    }, []);\n\n    const login = async (\n        email: string,\n        password: string,\n        type: 'user' | 'customer'\n    ): Promise<{ success: boolean; error?: string }> => {\n        console.log('AuthContext Login calling API:', { email, type });\n        try {\n            const response = await fetch('/api/v1/auth/login', {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({ email, password, type }),\n            });\n\n            const data = await response.json();\n\n            if (!data.success) {\n                return { success: false, error: data.error || 'Login failed' };\n            }\n\n            // Store auth state\n            localStorage.setItem('token', data.data.token);\n            localStorage.setItem('refreshToken', data.data.refreshToken);\n            localStorage.setItem('user', JSON.stringify(data.data.user));\n            localStorage.setItem('userType', type);\n\n            setToken(data.data.token);\n            setUser(data.data.user);\n            setUserType(type);\n\n            // Redirect based on user type\n            if (type === 'customer') {\n                router.push('/customer/dashboard');\n            } else {\n                const roleCode = data.data.user.roleCode;\n                if (roleCode === 'ADMIN') {\n                    router.push('/admin/dashboard');\n                } else {\n                    router.push('/banker/dashboard');\n                }\n            }\n\n            return { success: true };\n        } catch (error) {\n            console.error('Login error:', error);\n            return { success: false, error: 'Network error. Please try again.' };\n        }\n    };\n\n    const logout = () => {\n        localStorage.removeItem('token');\n        localStorage.removeItem('refreshToken');\n        localStorage.removeItem('user');\n        localStorage.removeItem('userType');\n        setToken(null);\n        setUser(null);\n        setUserType(null);\n        router.push('/login');\n    };\n\n    const hasPermission = (permission: string): boolean => {\n        if (!user || !user.permissions) return false;\n        return user.permissions.includes(permission);\n    };\n\n    const isRole = (role: string): boolean => {\n        if (!user || !user.roleCode) return false;\n        return user.roleCode === role;\n    };\n\n    return (\n        <AuthContext.Provider\n            value={{\n                user,\n                token,\n                isLoading,\n                isAuthenticated: !!token && !!user,\n                userType,\n                login,\n                logout,\n                hasPermission,\n                isRole,\n            }}\n        >\n            {children}\n        </AuthContext.Provider>\n    );\n}\n\n// =============================================================================\n// Hook\n// =============================================================================\n\nexport function useAuth() {\n    const context = useContext(AuthContext);\n    if (context === undefined) {\n        throw new Error('useAuth must be used within an AuthProvider');\n    }\n    return context;\n}\n\n// =============================================================================\n// API Client Helper\n// =============================================================================\n\nexport async function apiClient<T>(\n    endpoint: string,\n    options: RequestInit = {}\n): Promise<{ success: boolean; data?: T; error?: string }> {\n    const token = localStorage.getItem('token');\n\n    const headers: HeadersInit = {\n        'Content-Type': 'application/json',\n        ...(token && { Authorization: `Bearer ${token}` }),\n        ...options.headers,\n    };\n\n    try {\n        const response = await fetch(`/api/v1${endpoint}`, {\n            ...options,\n            headers,\n        });\n\n        const data = await response.json();\n\n        if (!response.ok) {\n            // Handle token expiration\n            if (response.status === 401) {\n                // Try to refresh token\n                const refreshToken = localStorage.getItem('refreshToken');\n                if (refreshToken) {\n                    const refreshResponse = await fetch('/api/v1/auth/refresh', {\n                        method: 'POST',\n                        headers: { 'Content-Type': 'application/json' },\n                        body: JSON.stringify({ refreshToken }),\n                    });\n\n                    if (refreshResponse.ok) {\n                        const refreshData = await refreshResponse.json();\n                        localStorage.setItem('token', refreshData.data.token);\n\n                        // Retry original request with new token\n                        const retryResponse = await fetch(`/api/v1${endpoint}`, {\n                            ...options,\n                            headers: {\n                                ...headers,\n                                Authorization: `Bearer ${refreshData.data.token}`,\n                            },\n                        });\n                        return await retryResponse.json();\n                    }\n                }\n\n                // Clear auth and redirect to login\n                localStorage.removeItem('token');\n                localStorage.removeItem('refreshToken');\n                localStorage.removeItem('user');\n                localStorage.removeItem('userType');\n                window.location.href = '/login';\n            }\n\n            return { success: false, error: data.error || 'Request failed' };\n        }\n\n        return data;\n    } catch (error) {\n        console.error('API error:', error);\n        return { success: false, error: 'Network error. Please try again.' };\n    }\n}\n"],"names":[],"mappings":";;;;;;;;;AAEA;AACA;AAHA;;;;AAiCA,gFAAgF;AAChF,UAAU;AACV,gFAAgF;AAEhF,MAAM,4BAAc,IAAA,sNAAa,EAA8B;AAMxD,SAAS,aAAa,EAAE,QAAQ,EAA2B;IAC9D,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAc;IAC9C,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAgB;IAClD,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,iNAAQ,EAA6B;IACrE,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAC;IAC3C,MAAM,SAAS,IAAA,+IAAS;IAExB,6CAA6C;IAC7C,IAAA,kNAAS,EAAC;QACN,MAAM,cAAc,aAAa,OAAO,CAAC;QACzC,MAAM,aAAa,aAAa,OAAO,CAAC;QACxC,MAAM,iBAAiB,aAAa,OAAO,CAAC;QAE5C,IAAI,eAAe,YAAY;YAC3B,SAAS;YACT,QAAQ,KAAK,KAAK,CAAC;YACnB,YAAY;QAChB;QACA,aAAa;IACjB,GAAG,EAAE;IAEL,MAAM,QAAQ,OACV,OACA,UACA;QAEA,QAAQ,GAAG,CAAC,kCAAkC;YAAE;YAAO;QAAK;QAC5D,IAAI;YACA,MAAM,WAAW,MAAM,MAAM,sBAAsB;gBAC/C,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBAAE;oBAAO;oBAAU;gBAAK;YACjD;YAEA,MAAM,OAAO,MAAM,SAAS,IAAI;YAEhC,IAAI,CAAC,KAAK,OAAO,EAAE;gBACf,OAAO;oBAAE,SAAS;oBAAO,OAAO,KAAK,KAAK,IAAI;gBAAe;YACjE;YAEA,mBAAmB;YACnB,aAAa,OAAO,CAAC,SAAS,KAAK,IAAI,CAAC,KAAK;YAC7C,aAAa,OAAO,CAAC,gBAAgB,KAAK,IAAI,CAAC,YAAY;YAC3D,aAAa,OAAO,CAAC,QAAQ,KAAK,SAAS,CAAC,KAAK,IAAI,CAAC,IAAI;YAC1D,aAAa,OAAO,CAAC,YAAY;YAEjC,SAAS,KAAK,IAAI,CAAC,KAAK;YACxB,QAAQ,KAAK,IAAI,CAAC,IAAI;YACtB,YAAY;YAEZ,8BAA8B;YAC9B,IAAI,SAAS,YAAY;gBACrB,OAAO,IAAI,CAAC;YAChB,OAAO;gBACH,MAAM,WAAW,KAAK,IAAI,CAAC,IAAI,CAAC,QAAQ;gBACxC,IAAI,aAAa,SAAS;oBACtB,OAAO,IAAI,CAAC;gBAChB,OAAO;oBACH,OAAO,IAAI,CAAC;gBAChB;YACJ;YAEA,OAAO;gBAAE,SAAS;YAAK;QAC3B,EAAE,OAAO,OAAO;YACZ,QAAQ,KAAK,CAAC,gBAAgB;YAC9B,OAAO;gBAAE,SAAS;gBAAO,OAAO;YAAmC;QACvE;IACJ;IAEA,MAAM,SAAS;QACX,aAAa,UAAU,CAAC;QACxB,aAAa,UAAU,CAAC;QACxB,aAAa,UAAU,CAAC;QACxB,aAAa,UAAU,CAAC;QACxB,SAAS;QACT,QAAQ;QACR,YAAY;QACZ,OAAO,IAAI,CAAC;IAChB;IAEA,MAAM,gBAAgB,CAAC;QACnB,IAAI,CAAC,QAAQ,CAAC,KAAK,WAAW,EAAE,OAAO;QACvC,OAAO,KAAK,WAAW,CAAC,QAAQ,CAAC;IACrC;IAEA,MAAM,SAAS,CAAC;QACZ,IAAI,CAAC,QAAQ,CAAC,KAAK,QAAQ,EAAE,OAAO;QACpC,OAAO,KAAK,QAAQ,KAAK;IAC7B;IAEA,qBACI,8OAAC,YAAY,QAAQ;QACjB,OAAO;YACH;YACA;YACA;YACA,iBAAiB,CAAC,CAAC,SAAS,CAAC,CAAC;YAC9B;YACA;YACA;YACA;YACA;QACJ;kBAEC;;;;;;AAGb;AAMO,SAAS;IACZ,MAAM,UAAU,IAAA,mNAAU,EAAC;IAC3B,IAAI,YAAY,WAAW;QACvB,MAAM,IAAI,MAAM;IACpB;IACA,OAAO;AACX;AAMO,eAAe,UAClB,QAAgB,EAChB,UAAuB,CAAC,CAAC;IAEzB,MAAM,QAAQ,aAAa,OAAO,CAAC;IAEnC,MAAM,UAAuB;QACzB,gBAAgB;QAChB,GAAI,SAAS;YAAE,eAAe,CAAC,OAAO,EAAE,OAAO;QAAC,CAAC;QACjD,GAAG,QAAQ,OAAO;IACtB;IAEA,IAAI;QACA,MAAM,WAAW,MAAM,MAAM,CAAC,OAAO,EAAE,UAAU,EAAE;YAC/C,GAAG,OAAO;YACV;QACJ;QAEA,MAAM,OAAO,MAAM,SAAS,IAAI;QAEhC,IAAI,CAAC,SAAS,EAAE,EAAE;YACd,0BAA0B;YAC1B,IAAI,SAAS,MAAM,KAAK,KAAK;gBACzB,uBAAuB;gBACvB,MAAM,eAAe,aAAa,OAAO,CAAC;gBAC1C,IAAI,cAAc;oBACd,MAAM,kBAAkB,MAAM,MAAM,wBAAwB;wBACxD,QAAQ;wBACR,SAAS;4BAAE,gBAAgB;wBAAmB;wBAC9C,MAAM,KAAK,SAAS,CAAC;4BAAE;wBAAa;oBACxC;oBAEA,IAAI,gBAAgB,EAAE,EAAE;wBACpB,MAAM,cAAc,MAAM,gBAAgB,IAAI;wBAC9C,aAAa,OAAO,CAAC,SAAS,YAAY,IAAI,CAAC,KAAK;wBAEpD,wCAAwC;wBACxC,MAAM,gBAAgB,MAAM,MAAM,CAAC,OAAO,EAAE,UAAU,EAAE;4BACpD,GAAG,OAAO;4BACV,SAAS;gCACL,GAAG,OAAO;gCACV,eAAe,CAAC,OAAO,EAAE,YAAY,IAAI,CAAC,KAAK,EAAE;4BACrD;wBACJ;wBACA,OAAO,MAAM,cAAc,IAAI;oBACnC;gBACJ;gBAEA,mCAAmC;gBACnC,aAAa,UAAU,CAAC;gBACxB,aAAa,UAAU,CAAC;gBACxB,aAAa,UAAU,CAAC;gBACxB,aAAa,UAAU,CAAC;gBACxB,OAAO,QAAQ,CAAC,IAAI,GAAG;YAC3B;YAEA,OAAO;gBAAE,SAAS;gBAAO,OAAO,KAAK,KAAK,IAAI;YAAiB;QACnE;QAEA,OAAO;IACX,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,cAAc;QAC5B,OAAO;YAAE,SAAS;YAAO,OAAO;QAAmC;IACvE;AACJ"}},
    {"offset": {"line": 232, "column": 0}, "map": {"version":3,"sources":["file:///home/mohammadirfan/bclatest/src/components/ui/sonner.tsx"],"sourcesContent":["\"use client\"\n\nimport {\n  CircleCheckIcon,\n  InfoIcon,\n  Loader2Icon,\n  OctagonXIcon,\n  TriangleAlertIcon,\n} from \"lucide-react\"\nimport { useTheme } from \"next-themes\"\nimport { Toaster as Sonner, type ToasterProps } from \"sonner\"\n\nconst Toaster = ({ ...props }: ToasterProps) => {\n  const { theme = \"system\" } = useTheme()\n\n  return (\n    <Sonner\n      theme={theme as ToasterProps[\"theme\"]}\n      className=\"toaster group\"\n      icons={{\n        success: <CircleCheckIcon className=\"size-4\" />,\n        info: <InfoIcon className=\"size-4\" />,\n        warning: <TriangleAlertIcon className=\"size-4\" />,\n        error: <OctagonXIcon className=\"size-4\" />,\n        loading: <Loader2Icon className=\"size-4 animate-spin\" />,\n      }}\n      style={\n        {\n          \"--normal-bg\": \"var(--popover)\",\n          \"--normal-text\": \"var(--popover-foreground)\",\n          \"--normal-border\": \"var(--border)\",\n          \"--border-radius\": \"var(--radius)\",\n        } as React.CSSProperties\n      }\n      {...props}\n    />\n  )\n}\n\nexport { Toaster }\n"],"names":[],"mappings":";;;;;AAEA;AAAA;AAAA;AAAA;AAAA;AAOA;AACA;AAVA;;;;;AAYA,MAAM,UAAU,CAAC,EAAE,GAAG,OAAqB;IACzC,MAAM,EAAE,QAAQ,QAAQ,EAAE,GAAG,IAAA,4JAAQ;IAErC,qBACE,8OAAC,mJAAM;QACL,OAAO;QACP,WAAU;QACV,OAAO;YACL,uBAAS,8OAAC,2OAAe;gBAAC,WAAU;;;;;;YACpC,oBAAM,8OAAC,kNAAQ;gBAAC,WAAU;;;;;;YAC1B,uBAAS,8OAAC,iPAAiB;gBAAC,WAAU;;;;;;YACtC,qBAAO,8OAAC,kOAAY;gBAAC,WAAU;;;;;;YAC/B,uBAAS,8OAAC,oOAAW;gBAAC,WAAU;;;;;;QAClC;QACA,OACE;YACE,eAAe;YACf,iBAAiB;YACjB,mBAAmB;YACnB,mBAAmB;QACrB;QAED,GAAG,KAAK;;;;;;AAGf"}}]
}