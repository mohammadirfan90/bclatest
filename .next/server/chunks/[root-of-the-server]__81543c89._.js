module.exports=[70406,(e,t,a)=>{t.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},18622,(e,t,a)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(e,t,a)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(e,t,a)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},24725,(e,t,a)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},24361,(e,t,a)=>{t.exports=e.x("util",()=>require("util"))},14747,(e,t,a)=>{t.exports=e.x("path",()=>require("path"))},93695,(e,t,a)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},54799,(e,t,a)=>{t.exports=e.x("crypto",()=>require("crypto"))},74129,e=>{"use strict";var t=e.i(1265),a=e.i(90727),r=e.i(43793),n=e.i(23076);function s(e,a){return t.NextResponse.json({success:!0,data:e,meta:a},{status:200})}function o(e){return t.NextResponse.json({success:!0,data:e},{status:201})}function c(e,a=400){return t.NextResponse.json({success:!1,error:e},{status:a})}function i(e){return t.NextResponse.json({success:!1,error:"Validation failed",errors:e},{status:400})}function u(e="Unauthorized"){return t.NextResponse.json({success:!1,error:e},{status:401})}function d(e="Forbidden"){return t.NextResponse.json({success:!1,error:e},{status:403})}function l(e="Not found"){return t.NextResponse.json({success:!1,error:e},{status:404})}function p(e="Internal server error"){return t.NextResponse.json({success:!1,error:e},{status:500})}async function y(e,t,n={}){let{requiredType:s="any",requiredRoles:o,requiredPermissions:c,hideFailure:i=!1}=n,p=e=>i?l():e,E=e.headers.get("authorization");if(!E||!E.startsWith("Bearer "))return p(u("No token provided"));let _=E.substring(7),m=(0,a.verifyToken)(_);if(!m)return p(u("Invalid or expired token"));if("any"!==s&&m.type!==s)return p(d(`Access restricted to ${s}s`));if(e.tokenPayload=m,"user"===m.type){let[t]=await (0,r.query)(`SELECT u.id, u.email, u.first_name, u.last_name, u.role_id,
              r.code as role_code, r.name as role_name, r.permissions,
              u.status
       FROM users u
       INNER JOIN roles r ON r.id = u.role_id
       WHERE u.id = ? AND u.status = 'ACTIVE'`,[m.sub]);if(!t)return p(u("User not found or inactive"));let a=[];try{let e=t.permissions;e&&"string"==typeof e&&e.startsWith("[")?a=JSON.parse(e):Array.isArray(e)&&(a=e)}catch(e){console.warn("Invalid permissions JSON, defaulting to empty array"),a=[]}if(e.user={id:t.id,email:t.email,firstName:t.first_name,lastName:t.last_name,roleId:t.role_id,roleCode:t.role_code,roleName:t.role_name,permissions:a,status:t.status,mfaEnabled:!1},o&&o.length>0&&!o.includes(t.role_code))return p(d("Insufficient role privileges"));if(c&&c.length>0&&!c.some(e=>a.includes(e)))return p(d("Insufficient permissions"))}if("customer"===m.type){let[t]=await (0,r.query)(`SELECT id, customer_number, email, status
       FROM customers
       WHERE id = ? AND status = 'ACTIVE'`,[m.sub]);if(!t)return u("Customer not found or inactive");e.customer={id:t.id,customerNumber:t.customer_number,email:t.email}}return t(e)}async function E(e,t){try{let a=await e.json(),r=t.parse(a);return{success:!0,data:r}}catch(e){if(e instanceof n.ZodError)return{success:!1,response:i(e.issues.map(e=>({field:e.path.join("."),message:e.message})))};return{success:!1,response:c("Invalid request body")}}}function _(e,t){try{let a=Object.fromEntries(e.nextUrl.searchParams.entries()),r=t.parse(a);return{success:!0,data:r}}catch(e){if(e instanceof n.ZodError)return{success:!1,response:i(e.issues.map(e=>({field:e.path.join("."),message:e.message})))};return{success:!1,response:c("Invalid query parameters")}}}function m(e){return e.headers.get("Idempotency-Key")||e.headers.get("idempotency-key")||null}async function f(e){if(!e)return{cached:!1};let[a]=await (0,r.query)(`SELECT response_status, response_body
     FROM idempotency_keys
     WHERE idempotency_key = ? AND expires_at > NOW()`,[e]);if(a){let e=JSON.parse(a.response_body);return{cached:!0,response:t.NextResponse.json(e,{status:a.response_status})}}return{cached:!1}}function h(e){return async(t,a)=>{try{return await e(t,a)}catch(e){if(console.error("API Error:",e),e instanceof Error)return p("An unexpected error occurred");return p()}}}function R(e,t,a){return{page:e,limit:t,total:a,totalPages:Math.ceil(a/t)}}function N(e,t){return(e-1)*t}e.s(["checkIdempotency",()=>f,"createdResponse",()=>o,"errorResponse",()=>c,"getIdempotencyKey",()=>m,"getOffset",()=>N,"getPaginationMeta",()=>R,"notFoundResponse",()=>l,"successResponse",()=>s,"validateBody",()=>E,"validateQuery",()=>_,"validationErrorResponse",()=>i,"withAuth",()=>y,"withErrorHandler",()=>h])},31931,e=>{"use strict";var t=e.i(43793);async function a(e){let a=await (0,t.queryOne)(`SELECT a.id, a.account_number, a.customer_id, a.account_type_id,
                at.code as account_type, at.name as account_type_name,
                a.status, a.created_at,
                COALESCE(ab.currency, 'BDT') as currency
         FROM accounts a
         JOIN account_types at ON at.id = a.account_type_id
         LEFT JOIN account_balances ab ON ab.account_id = a.id
         WHERE a.id = ?`,[e]);return a?{id:a.id,accountNumber:a.account_number,customerId:a.customer_id,accountType:a.account_type,currency:a.currency,status:a.status,openedAt:a.created_at,createdAt:a.created_at}:null}async function r(e){let a=await (0,t.queryOne)(`SELECT a.id, a.account_number, a.customer_id, a.account_type_id,
                at.code as account_type, at.name as account_type_name,
                a.status, a.created_at,
                COALESCE(ab.currency, 'BDT') as currency
         FROM accounts a
         JOIN account_types at ON at.id = a.account_type_id
         LEFT JOIN account_balances ab ON ab.account_id = a.id
         WHERE a.account_number = ?`,[e]);return a?{id:a.id,accountNumber:a.account_number,customerId:a.customer_id,accountType:a.account_type,currency:a.currency,status:a.status,openedAt:a.created_at,createdAt:a.created_at}:null}async function n(e){return(await (0,t.query)(`SELECT a.id, a.account_number, a.customer_id, a.account_type_id,
                at.code as account_type, at.name as account_type_name,
                a.status, a.created_at,
                c.first_name, c.last_name,
                COALESCE(ab.available_balance, 0) as available_balance,
                COALESCE(ab.currency, 'BDT') as currency
         FROM accounts a
         JOIN customers c ON c.id = a.customer_id
         JOIN account_types at ON at.id = a.account_type_id
         LEFT JOIN account_balances ab ON ab.account_id = a.id
         WHERE a.customer_id = ?
         ORDER BY a.created_at DESC`,[e])).map(e=>({id:e.id,accountNumber:e.account_number,customerId:e.customer_id,accountType:e.account_type,accountTypeName:e.account_type_name,currency:e.currency,status:e.status,openedAt:e.created_at,createdAt:e.created_at,customerName:`${e.first_name} ${e.last_name}`,balance:{availableBalance:parseFloat(e.available_balance||"0")}}))}async function s(e,a,r){try{return await (0,t.query)('UPDATE accounts SET status = "SUSPENDED", updated_at = NOW() WHERE id = ?',[e]),{success:!0}}catch(e){return console.error("Error freezing account:",e),{success:!1,error:"Failed"}}}async function o(e,a,r){try{return await (0,t.query)('UPDATE accounts SET status = "ACTIVE", updated_at = NOW() WHERE id = ?',[e]),{success:!0}}catch(e){return console.error("Error unfreezing account:",e),{success:!1,error:"Failed"}}}async function c(e,a,r){try{let a=await (0,t.queryOne)("SELECT available_balance FROM account_balances WHERE account_id = ?",[e]),r=parseFloat(a?.available_balance||"0");if(0!==r)return{success:!1,error:`Cannot close account. Non-zero balance: ${r}`};return await (0,t.query)('UPDATE accounts SET status = "CLOSED", updated_at = NOW() WHERE id = ?',[e]),{success:!0}}catch(e){return console.error("Error closing account:",e),{success:!1,error:"Failed"}}}async function i(e,a,r){try{if(!await (0,t.queryOne)("SELECT id FROM customers WHERE id = ?",[e]))return{success:!1,error:"Customer not found"};let n=String(e).padStart(4,"0"),s=String(Math.floor(1e3+9e3*Math.random())),o=`1001-${n}-${s}`;return await (0,t.withTransaction)(async t=>{let[n]=await t.execute(`INSERT INTO accounts (account_number, customer_id, account_type_id, status, opened_at, created_at, created_by)
                 VALUES (?, ?, ?, 'ACTIVE', NOW(), NOW(), ?)`,[o,e,a,r||null]),s=n.insertId;return await t.execute(`INSERT INTO account_balances (account_id, available_balance, currency, version)
                 VALUES (?, 0.0000, 'BDT', 1)`,[s]),{success:!0,accountId:s,accountNumber:o}})}catch(e){return console.error("Error creating account:",e),{success:!1,error:"Database error during account creation"}}}async function u(e,a){let r=await (0,t.queryOne)("SELECT id FROM account_types WHERE code = ?",[a]);if(!r)return{success:!1,error:"Invalid account type"};let n=await i(e,r.id);return n.success?{success:!0,applicationId:n.accountId}:{success:!1,error:n.error}}async function d(a){try{let r="Welcome!"+Math.floor(1e3+9e3*Math.random()),{hashPassword:n}=await e.A(543),s=await n(r),o=await (0,t.execute)(`INSERT INTO customers 
             (customer_number, email, first_name, last_name, date_of_birth, status, kyc_status, created_at, created_by, password_hash)
             VALUES (?, ?, ?, ?, ?, 'ACTIVE', 'VERIFIED', NOW(), ?, ?)`,[a.customerNumber,a.email,a.firstName,a.lastName,a.dateOfBirth,a.createdBy,s]);return{success:!0,customerId:o.insertId,tempPassword:r}}catch(e){if("ER_DUP_ENTRY"===e.code)return{success:!1,error:"Email or Customer Number already exists"};return console.error("Error during customer creation:",e),{success:!1,error:"Database error during customer creation"}}}async function l(e){}e.s(["applyForAccount",()=>u,"closeAccount",()=>c,"createAccount",()=>i,"freezeAccount",()=>s,"getAccountById",()=>a,"getAccountByNumber",()=>r,"getAccountsForCustomer",()=>n,"onboardNewCustomer",()=>d,"refreshAccountBalance",()=>l,"unfreezeAccount",()=>o])},11585,e=>{"use strict";var t=e.i(43793);e.i(1612);var a=e.i(30497),r=e.i(4489),n=e.i(21854);async function s(e,a){let{from:r,to:n,page:s=1,size:o=50}=a,c=(s-1)*o,i=await (0,t.queryOne)(`SELECT a.id, a.account_number, at.name as account_type_name,
                CONCAT(c.first_name, ' ', c.last_name) as customer_name
         FROM accounts a
         JOIN customers c ON a.customer_id = c.id
         JOIN account_types at ON at.id = a.account_type_id
         WHERE a.id = ?`,[e]);if(!i)throw Error("Account not found");let u=await (0,t.queryOne)(`SELECT 
            COALESCE(SUM(CASE WHEN entry_type = 'CREDIT' THEN amount ELSE 0 END), 0) as total_credits,
            COALESCE(SUM(CASE WHEN entry_type = 'DEBIT' THEN amount ELSE 0 END), 0) as total_debits
         FROM ledger_entries
         WHERE account_id = ? AND entry_date < ?`,[e,r]),d=parseFloat(u?.total_credits||"0")-parseFloat(u?.total_debits||"0"),l=await (0,t.queryOne)(`SELECT COUNT(*) as count
         FROM ledger_entries le
         WHERE le.account_id = ? AND le.entry_date >= ? AND le.entry_date <= ?`,[e,r,n]),p=l?.count||0,y=await (0,t.queryOne)(`SELECT 
            COALESCE(SUM(CASE WHEN entry_type = 'CREDIT' THEN amount ELSE 0 END), 0) as total_credits,
            COALESCE(SUM(CASE WHEN entry_type = 'DEBIT' THEN amount ELSE 0 END), 0) as total_debits
         FROM ledger_entries
         WHERE account_id = ? AND entry_date >= ? AND entry_date <= ?`,[e,r,n]),E=parseFloat(y?.total_credits||"0"),_=parseFloat(y?.total_debits||"0"),m=await (0,t.query)(`SELECT le.id, le.transaction_id, le.account_id, le.entry_type, 
                le.amount, le.currency, le.balance_after, le.description,
                le.entry_date, le.created_at, t.transaction_reference,
                tt.code as transaction_type
         FROM ledger_entries le
         JOIN transactions t ON le.transaction_id = t.id
         JOIN transaction_types tt ON t.transaction_type_id = tt.id
         WHERE le.account_id = ? AND le.entry_date >= ? AND le.entry_date <= ?
         ORDER BY le.created_at ASC, le.id ASC
         LIMIT ? OFFSET ?`,[e,r,n,o,c]),f=d;if(s>1){let a=await (0,t.queryOne)(`SELECT 
                COALESCE(SUM(CASE WHEN entry_type = 'CREDIT' THEN amount ELSE 0 END), 0) as total_credits,
                COALESCE(SUM(CASE WHEN entry_type = 'DEBIT' THEN amount ELSE 0 END), 0) as total_debits
             FROM (
                SELECT entry_type, amount
                FROM ledger_entries
                WHERE account_id = ? AND entry_date >= ? AND entry_date <= ?
                ORDER BY created_at ASC, id ASC
                LIMIT ?
             ) as previous_entries`,[e,r,n,c]);f=d+parseFloat(a?.total_credits||"0")-parseFloat(a?.total_debits||"0")}let h=m.map(e=>{let t=parseFloat(e.amount);return"CREDIT"===e.entry_type?f+=t:f-=t,{id:e.id,date:e.entry_date,description:e.description,debit:"DEBIT"===e.entry_type?t:null,credit:"CREDIT"===e.entry_type?t:null,runningBalance:Math.round(100*f)/100,transactionReference:e.transaction_reference,transactionType:e.transaction_type}});return{statement:{account:{id:i.id,accountNumber:i.account_number,accountType:i.account_type_name,customerName:i.customer_name},period:{from:r,to:n},openingBalance:Math.round(100*d)/100,closingBalance:Math.round(100*(d+E-_))/100,totalDebits:Math.round(100*_)/100,totalCredits:Math.round(100*E)/100,entries:h},total:p}}function o(e){return new Intl.NumberFormat("en-BD",{style:"currency",currency:"BDT",minimumFractionDigits:2}).format(e)}function c(e){return new Intl.DateTimeFormat("en-GB",{day:"2-digit",month:"short",year:"numeric"}).format(new Date(e))}async function i(e,t,i){let{statement:u}=await s(e,{from:t,to:i,page:1,size:1e4}),d=await a.PDFDocument.create(),l=await d.embedFont(r.StandardFonts.Helvetica),p=await d.embedFont(r.StandardFonts.HelveticaBold),y=d.addPage([595.28,841.89]),{width:E,height:_}=y.getSize(),m=_-50,f=()=>(y=d.addPage([595.28,841.89]),m=_-50,y),h=(e,t,a,r=10,s=l,o=(0,n.rgb)(0,0,0))=>{y.drawText(e,{x:t,y:a,size:r,font:s,color:o})};(0,n.rgb)(0,0,0);let R=(0,n.rgb)(.3,.3,.3),N="BNKCORE",g=p.widthOfTextAtSize(N,22);h(N,(E-g)/2,m,22,p),m-=25;let b="Core Banking System",O=l.widthOfTextAtSize(b,10);h(b,(E-O)/2,m,10,l),m-=35;let T="Account Statement",A=p.widthOfTextAtSize(T,16);h(T,(E-A)/2,m,16,p);let C=m-=45;h("Account Holder:",50,m,10,p),h(u.account.customerName,140,m,10,l),h("Account Number:",50,m-=18,10,p),h(u.account.accountNumber,140,m,10,l),h("Account Type:",50,m-=18,10,p),h(u.account.accountType,140,m,10,l),h("Statement Period:",320,C,10,p),h(`${c(new Date(t))} - ${c(new Date(i))}`,410,C,10,l),h("Generated:",320,C-18,10,p),h(c(new Date),410,C-18,10,l),m-=50,y.drawRectangle({x:50,y:m-55,width:E-100,height:65,borderColor:(0,n.rgb)(0,0,0),borderWidth:1});let w=m-20,S=m-45;h("Opening Balance:",65,w,10,p),h(o(u.openingBalance),160,w,10,p),h("Total Credits:",310,w,10,p),h(o(u.totalCredits),400,w,10,p),h("Closing Balance:",65,S,10,p),h(o(u.closingBalance),160,S,10,p),h("Total Debits:",310,S,10,p),h(o(u.totalDebits),400,S,10,p);let x=e=>{y.drawRectangle({x:50,y:e-18,width:E-100,height:25,color:(0,n.rgb)(.9,.9,.9)});let t=e-3;h("Date",55,t,9,p),h("Description",125,t,9,p);let a=(e,t,a,r,n=9,s=p)=>{let o=s.widthOfTextAtSize(e,n);h(e,t+a-o-5,r,n,s)};a("Debit",300,70,t),a("Credit",380,70,t),a("Balance",465,80,t)};x(m-=90),m-=30;let v=(e,t,a,r,n=8,s=l)=>{let o=s.widthOfTextAtSize(e,n);h(e,t+a-o-5,r,n,s)};for(let e of(h(c(new Date(t)),55,m,8,p),h("Opening Balance",125,m,8,p),v(o(u.openingBalance),465,80,m,8,p),m-=18,u.entries)){m<110&&(f(),x(m),m-=30),u.entries.indexOf(e)%2==1&&y.drawRectangle({x:50,y:m-5,width:E-100,height:18,color:(0,n.rgb)(.98,.98,.98)}),h(c(e.date),55,m,8,l,R);let t=e.description||e.transactionType;h(t.length>35?t.substring(0,32)+"...":t,125,m,8,l),e.debit&&v(o(e.debit),300,70,m,8,l),e.credit&&v(o(e.credit),380,70,m,8,l),v(o(e.runningBalance),465,80,m,8,l),m-=18}m<90&&(f(),x(m),m-=30),m-=5,h(c(new Date(i)),55,m,8,p),h("Closing Balance",125,m,8,p),v(o(u.closingBalance),465,80,m,8,p);let I=d.getPages();for(let e=0;e<I.length;e++){let t=I[e],a=`Page ${e+1} of ${I.length} | This is a computer-generated document and does not require signature.`,r=l.widthOfTextAtSize(a,8);t.drawText(a,{x:(E-r)/2,y:30,size:8,font:l,color:(0,n.rgb)(0,0,0)})}let D=await d.save();return Buffer.from(D)}async function u(e){let{from:a,to:r,amountMin:n,amountMax:s,entryType:o,transactionType:c,reference:i,accountId:u,includeReversals:d=!0,page:l=1,size:p=50}=e,y=["1=1"],E=[];a&&(y.push("le.entry_date >= ?"),E.push(a)),r&&(y.push("le.entry_date <= ?"),E.push(r)),void 0!==n&&(y.push("le.amount >= ?"),E.push(n)),void 0!==s&&(y.push("le.amount <= ?"),E.push(s)),o&&(y.push("le.entry_type = ?"),E.push(o)),c&&(y.push("tt.code = ?"),E.push(c)),i&&(y.push("(t.transaction_reference LIKE ? OR le.description LIKE ?)"),E.push(`%${i}%`,`%${i}%`)),u&&(y.push("le.account_id = ?"),E.push(u)),d||y.push("t.status != 'REVERSED'");let _=y.join(" AND "),m=await (0,t.queryOne)(`SELECT COUNT(*) as count
         FROM ledger_entries le
         JOIN transactions t ON le.transaction_id = t.id
         JOIN transaction_types tt ON t.transaction_type_id = tt.id
         JOIN accounts a ON le.account_id = a.id
         WHERE ${_}`,E);return{results:(await (0,t.query)(`SELECT le.id, t.transaction_reference, tt.code as transaction_type,
                le.account_id, a.account_number, le.entry_type, le.amount,
                le.balance_after, le.description, le.entry_date, le.created_at,
                (t.status = 'REVERSED') as is_reversal
         FROM ledger_entries le
         JOIN transactions t ON le.transaction_id = t.id
         JOIN transaction_types tt ON t.transaction_type_id = tt.id
         JOIN accounts a ON le.account_id = a.id
         WHERE ${_}
         ORDER BY le.created_at DESC, le.id DESC
         LIMIT ? OFFSET ?`,[...E,p,(l-1)*p])).map(e=>({id:e.id,transactionReference:e.transaction_reference,transactionType:e.transaction_type,accountId:e.account_id,accountNumber:e.account_number,entryType:e.entry_type,amount:parseFloat(e.amount),balanceAfter:parseFloat(e.balance_after),description:e.description,entryDate:e.entry_date,createdAt:e.created_at,isReversal:!!e.is_reversal})),total:m?.count||0}}function d(e){return["ID,Date,Transaction Ref,Type,Account Number,Entry Type,Amount,Balance After,Description,Is Reversal",...e.map(e=>[e.id,c(e.entryDate),e.transactionReference,e.transactionType,e.accountNumber,e.entryType,e.amount.toFixed(2),e.balanceAfter.toFixed(2),`"${(e.description||"").replace(/"/g,'""')}"`,e.isReversal?"Yes":"No"]).map(e=>e.join(","))].join("\n")}e.s(["generateCsvFromResults",()=>d,"generateStatementPdf",()=>i,"getAccountStatement",()=>s,"searchTransactions",()=>u])},81827,e=>{"use strict";var t=e.i(2961),a=e.i(99823),r=e.i(20478),n=e.i(30188),s=e.i(64717),o=e.i(22511),c=e.i(86406),i=e.i(82039),u=e.i(85794),d=e.i(97655),l=e.i(16847),p=e.i(5777),y=e.i(19298),E=e.i(73225),_=e.i(2380),m=e.i(93695);e.i(99970);var f=e.i(26738),h=e.i(74129),R=e.i(11585),N=e.i(31931);let g=(0,h.withErrorHandler)(async(e,t)=>{let a=await t?.params,r=parseInt(a?.id||"0");return(0,h.withAuth)(e,async t=>{let a=await (0,N.getAccountById)(r);if(!a||t.tokenPayload?.type==="customer"&&a.customerId!==t.customer?.id)return(0,h.notFoundResponse)("Account not found");let{searchParams:n}=new URL(e.url),s=n.get("from"),o=n.get("to"),c=parseInt(n.get("page")||"1"),i=parseInt(n.get("size")||"50");if(!s||!o)return(0,h.errorResponse)("Missing required parameters: from and to dates are required");let u=/^\d{4}-\d{2}-\d{2}$/;if(!u.test(s)||!u.test(o))return(0,h.errorResponse)("Invalid date format. Use YYYY-MM-DD");if(new Date(s)>new Date(o))return(0,h.errorResponse)("Invalid date range: from date must be before to date");try{let{statement:e,total:t}=await (0,R.getAccountStatement)(r,{from:s,to:o,page:c,size:i});return(0,h.successResponse)(e,(0,h.getPaginationMeta)(c,i,t))}catch(e){return console.error("Statement generation error:",e),(0,h.errorResponse)("Failed to generate statement")}},{requiredType:"any"})});e.s(["GET",0,g],20414);var b=e.i(20414);let O=new t.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/v1/accounts/[id]/statement/route",pathname:"/api/v1/accounts/[id]/statement",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/src/app/api/v1/accounts/[id]/statement/route.ts",nextConfigOutput:"",userland:b}),{workAsyncStorage:T,workUnitAsyncStorage:A,serverHooks:C}=O;function w(){return(0,r.patchFetch)({workAsyncStorage:T,workUnitAsyncStorage:A})}async function S(e,t,r){O.isDev&&(0,n.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let h="/api/v1/accounts/[id]/statement/route";h=h.replace(/\/index$/,"")||"/";let R=await O.prepare(e,t,{srcPage:h,multiZoneDraftMode:!1});if(!R)return t.statusCode=400,t.end("Bad Request"),null==r.waitUntil||r.waitUntil.call(r,Promise.resolve()),null;let{buildId:N,params:g,nextConfig:b,parsedUrl:T,isDraftMode:A,prerenderManifest:C,routerServerContext:w,isOnDemandRevalidate:S,revalidateOnlyGenerated:x,resolvedPathname:v,clientReferenceManifest:I,serverActionsManifest:D}=R,F=(0,c.normalizeAppPath)(h),H=!!(C.dynamicRoutes[F]||C.routes[v]),M=async()=>((null==w?void 0:w.render404)?await w.render404(e,t,T,!1):t.end("This page could not be found"),null);if(H&&!A){let e=!!C.routes[v],t=C.dynamicRoutes[F];if(t&&!1===t.fallback&&!e){if(b.experimental.adapterPath)return await M();throw new m.NoFallbackError}}let L=null;!H||O.isDev||A||(L="/index"===(L=v)?"/":L);let q=!0===O.isDev||!H,B=H&&!q;D&&I&&(0,o.setManifestsSingleton)({page:h,clientReferenceManifest:I,serverActionsManifest:D});let P=e.method||"GET",W=(0,s.getTracer)(),U=W.getActiveScopeSpan(),j={params:g,prerenderManifest:C,renderOpts:{experimental:{authInterrupts:!!b.experimental.authInterrupts},cacheComponents:!!b.cacheComponents,supportsDynamicResponse:q,incrementalCache:(0,n.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:b.cacheLife,waitUntil:r.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,a,r,n)=>O.onRequestError(e,t,r,n,w)},sharedContext:{buildId:N}},k=new i.NodeNextRequest(e),$=new i.NodeNextResponse(t),J=u.NextRequestAdapter.fromNodeNextRequest(k,(0,u.signalFromNodeResponse)(t));try{let o=async e=>O.handle(J,j).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let a=W.getRootSpanAttributes();if(!a)return;if(a.get("next.span_type")!==d.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${a.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let r=a.get("next.route");if(r){let t=`${P} ${r}`;e.setAttributes({"next.route":r,"http.route":r,"next.span_name":t}),e.updateName(t)}else e.updateName(`${P} ${h}`)}),c=!!(0,n.getRequestMeta)(e,"minimalMode"),i=async n=>{var s,i;let u=async({previousCacheEntry:a})=>{try{if(!c&&S&&x&&!a)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let s=await o(n);e.fetchMetrics=j.renderOpts.fetchMetrics;let i=j.renderOpts.pendingWaitUntil;i&&r.waitUntil&&(r.waitUntil(i),i=void 0);let u=j.renderOpts.collectedTags;if(!H)return await (0,p.sendResponse)(k,$,s,j.renderOpts.pendingWaitUntil),null;{let e=await s.blob(),t=(0,y.toNodeOutgoingHttpHeaders)(s.headers);u&&(t[_.NEXT_CACHE_TAGS_HEADER]=u),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let a=void 0!==j.renderOpts.collectedRevalidate&&!(j.renderOpts.collectedRevalidate>=_.INFINITE_CACHE)&&j.renderOpts.collectedRevalidate,r=void 0===j.renderOpts.collectedExpire||j.renderOpts.collectedExpire>=_.INFINITE_CACHE?void 0:j.renderOpts.collectedExpire;return{value:{kind:f.CachedRouteKind.APP_ROUTE,status:s.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:a,expire:r}}}}catch(t){throw(null==a?void 0:a.isStale)&&await O.onRequestError(e,t,{routerKind:"App Router",routePath:h,routeType:"route",revalidateReason:(0,l.getRevalidateReason)({isStaticGeneration:B,isOnDemandRevalidate:S})},!1,w),t}},d=await O.handleResponse({req:e,nextConfig:b,cacheKey:L,routeKind:a.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:C,isRoutePPREnabled:!1,isOnDemandRevalidate:S,revalidateOnlyGenerated:x,responseGenerator:u,waitUntil:r.waitUntil,isMinimalMode:c});if(!H)return null;if((null==d||null==(s=d.value)?void 0:s.kind)!==f.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==d||null==(i=d.value)?void 0:i.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});c||t.setHeader("x-nextjs-cache",S?"REVALIDATED":d.isMiss?"MISS":d.isStale?"STALE":"HIT"),A&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let m=(0,y.fromNodeOutgoingHttpHeaders)(d.value.headers);return c&&H||m.delete(_.NEXT_CACHE_TAGS_HEADER),!d.cacheControl||t.getHeader("Cache-Control")||m.get("Cache-Control")||m.set("Cache-Control",(0,E.getCacheControlHeader)(d.cacheControl)),await (0,p.sendResponse)(k,$,new Response(d.value.body,{headers:m,status:d.value.status||200})),null};U?await i(U):await W.withPropagatedContext(e.headers,()=>W.trace(d.BaseServerSpan.handleRequest,{spanName:`${P} ${h}`,kind:s.SpanKind.SERVER,attributes:{"http.method":P,"http.target":e.url}},i))}catch(t){if(t instanceof m.NoFallbackError||await O.onRequestError(e,t,{routerKind:"App Router",routePath:F,routeType:"route",revalidateReason:(0,l.getRevalidateReason)({isStaticGeneration:B,isOnDemandRevalidate:S})},!1,w),H)throw t;return await (0,p.sendResponse)(k,$,new Response(null,{status:500})),null}}e.s(["handler",()=>S,"patchFetch",()=>w,"routeModule",()=>O,"serverHooks",()=>C,"workAsyncStorage",()=>T,"workUnitAsyncStorage",()=>A],81827)},543,e=>{e.v(e=>Promise.resolve().then(()=>e(90727)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__81543c89._.js.map