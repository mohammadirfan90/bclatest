module.exports=[70406,(e,t,r)=>{t.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},18622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},24725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},24361,(e,t,r)=>{t.exports=e.x("util",()=>require("util"))},14747,(e,t,r)=>{t.exports=e.x("path",()=>require("path"))},93695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},54799,(e,t,r)=>{t.exports=e.x("crypto",()=>require("crypto"))},74129,e=>{"use strict";var t=e.i(1265),r=e.i(90727),n=e.i(43793),a=e.i(23076);function s(e,r){return t.NextResponse.json({success:!0,data:e,meta:r},{status:200})}function o(e){return t.NextResponse.json({success:!0,data:e},{status:201})}function i(e,r=400){return t.NextResponse.json({success:!1,error:e},{status:r})}function c(e){return t.NextResponse.json({success:!1,error:"Validation failed",errors:e},{status:400})}function u(e="Unauthorized"){return t.NextResponse.json({success:!1,error:e},{status:401})}function l(e="Forbidden"){return t.NextResponse.json({success:!1,error:e},{status:403})}function d(e="Not found"){return t.NextResponse.json({success:!1,error:e},{status:404})}function p(e="Internal server error"){return t.NextResponse.json({success:!1,error:e},{status:500})}async function y(e,t,a={}){let{requiredType:s="any",requiredRoles:o,requiredPermissions:i,hideFailure:c=!1}=a,p=e=>c?d():e,E=e.headers.get("authorization");if(!E||!E.startsWith("Bearer "))return p(u("No token provided"));let m=E.substring(7),_=(0,r.verifyToken)(m);if(!_)return p(u("Invalid or expired token"));if("any"!==s&&_.type!==s)return p(l(`Access restricted to ${s}s`));if(e.tokenPayload=_,"user"===_.type){let[t]=await (0,n.query)(`SELECT u.id, u.email, u.first_name, u.last_name, u.role_id,
              r.code as role_code, r.name as role_name, r.permissions,
              u.status
       FROM users u
       INNER JOIN roles r ON r.id = u.role_id
       WHERE u.id = ? AND u.status = 'ACTIVE'`,[_.sub]);if(!t)return p(u("User not found or inactive"));let r=[];try{let e=t.permissions;e&&"string"==typeof e&&e.startsWith("[")?r=JSON.parse(e):Array.isArray(e)&&(r=e)}catch(e){console.warn("Invalid permissions JSON, defaulting to empty array"),r=[]}if(e.user={id:t.id,email:t.email,firstName:t.first_name,lastName:t.last_name,roleId:t.role_id,roleCode:t.role_code,roleName:t.role_name,permissions:r,status:t.status,mfaEnabled:!1},o&&o.length>0&&!o.includes(t.role_code))return p(l("Insufficient role privileges"));if(i&&i.length>0&&!i.some(e=>r.includes(e)))return p(l("Insufficient permissions"))}if("customer"===_.type){let[t]=await (0,n.query)(`SELECT id, customer_number, email, status
       FROM customers
       WHERE id = ? AND status = 'ACTIVE'`,[_.sub]);if(!t)return u("Customer not found or inactive");e.customer={id:t.id,customerNumber:t.customer_number,email:t.email}}return t(e)}async function E(e,t){try{let r=await e.json(),n=t.parse(r);return{success:!0,data:n}}catch(e){if(e instanceof a.ZodError)return{success:!1,response:c(e.issues.map(e=>({field:e.path.join("."),message:e.message})))};return{success:!1,response:i("Invalid request body")}}}function m(e,t){try{let r=Object.fromEntries(e.nextUrl.searchParams.entries()),n=t.parse(r);return{success:!0,data:n}}catch(e){if(e instanceof a.ZodError)return{success:!1,response:c(e.issues.map(e=>({field:e.path.join("."),message:e.message})))};return{success:!1,response:i("Invalid query parameters")}}}function _(e){return e.headers.get("Idempotency-Key")||e.headers.get("idempotency-key")||null}async function h(e){if(!e)return{cached:!1};let[r]=await (0,n.query)(`SELECT response_status, response_body
     FROM idempotency_keys
     WHERE idempotency_key = ? AND expires_at > NOW()`,[e]);if(r){let e=JSON.parse(r.response_body);return{cached:!0,response:t.NextResponse.json(e,{status:r.response_status})}}return{cached:!1}}function f(e){return async(t,r)=>{try{return await e(t,r)}catch(e){if(console.error("API Error:",e),e instanceof Error)return p("An unexpected error occurred");return p()}}}function g(e,t,r){return{page:e,limit:t,total:r,totalPages:Math.ceil(r/t)}}function R(e,t){return(e-1)*t}e.s(["checkIdempotency",()=>h,"createdResponse",()=>o,"errorResponse",()=>i,"getIdempotencyKey",()=>_,"getOffset",()=>R,"getPaginationMeta",()=>g,"notFoundResponse",()=>d,"successResponse",()=>s,"validateBody",()=>E,"validateQuery",()=>m,"validationErrorResponse",()=>c,"withAuth",()=>y,"withErrorHandler",()=>f])},11585,e=>{"use strict";var t=e.i(43793);e.i(1612);var r=e.i(30497),n=e.i(4489),a=e.i(21854);async function s(e,r){let{from:n,to:a,page:s=1,size:o=50}=r,i=(s-1)*o,c=await (0,t.queryOne)(`SELECT a.id, a.account_number, at.name as account_type_name,
                CONCAT(c.first_name, ' ', c.last_name) as customer_name
         FROM accounts a
         JOIN customers c ON a.customer_id = c.id
         JOIN account_types at ON at.id = a.account_type_id
         WHERE a.id = ?`,[e]);if(!c)throw Error("Account not found");let u=await (0,t.queryOne)(`SELECT 
            COALESCE(SUM(CASE WHEN entry_type = 'CREDIT' THEN amount ELSE 0 END), 0) as total_credits,
            COALESCE(SUM(CASE WHEN entry_type = 'DEBIT' THEN amount ELSE 0 END), 0) as total_debits
         FROM ledger_entries
         WHERE account_id = ? AND entry_date < ?`,[e,n]),l=parseFloat(u?.total_credits||"0")-parseFloat(u?.total_debits||"0"),d=await (0,t.queryOne)(`SELECT COUNT(*) as count
         FROM ledger_entries le
         WHERE le.account_id = ? AND le.entry_date >= ? AND le.entry_date <= ?`,[e,n,a]),p=d?.count||0,y=await (0,t.queryOne)(`SELECT 
            COALESCE(SUM(CASE WHEN entry_type = 'CREDIT' THEN amount ELSE 0 END), 0) as total_credits,
            COALESCE(SUM(CASE WHEN entry_type = 'DEBIT' THEN amount ELSE 0 END), 0) as total_debits
         FROM ledger_entries
         WHERE account_id = ? AND entry_date >= ? AND entry_date <= ?`,[e,n,a]),E=parseFloat(y?.total_credits||"0"),m=parseFloat(y?.total_debits||"0"),_=await (0,t.query)(`SELECT le.id, le.transaction_id, le.account_id, le.entry_type, 
                le.amount, le.currency, le.balance_after, le.description,
                le.entry_date, le.created_at, t.transaction_reference,
                tt.code as transaction_type
         FROM ledger_entries le
         JOIN transactions t ON le.transaction_id = t.id
         JOIN transaction_types tt ON t.transaction_type_id = tt.id
         WHERE le.account_id = ? AND le.entry_date >= ? AND le.entry_date <= ?
         ORDER BY le.created_at ASC, le.id ASC
         LIMIT ? OFFSET ?`,[e,n,a,o,i]),h=l;if(s>1){let r=await (0,t.queryOne)(`SELECT 
                COALESCE(SUM(CASE WHEN entry_type = 'CREDIT' THEN amount ELSE 0 END), 0) as total_credits,
                COALESCE(SUM(CASE WHEN entry_type = 'DEBIT' THEN amount ELSE 0 END), 0) as total_debits
             FROM (
                SELECT entry_type, amount
                FROM ledger_entries
                WHERE account_id = ? AND entry_date >= ? AND entry_date <= ?
                ORDER BY created_at ASC, id ASC
                LIMIT ?
             ) as previous_entries`,[e,n,a,i]);h=l+parseFloat(r?.total_credits||"0")-parseFloat(r?.total_debits||"0")}let f=_.map(e=>{let t=parseFloat(e.amount);return"CREDIT"===e.entry_type?h+=t:h-=t,{id:e.id,date:e.entry_date,description:e.description,debit:"DEBIT"===e.entry_type?t:null,credit:"CREDIT"===e.entry_type?t:null,runningBalance:Math.round(100*h)/100,transactionReference:e.transaction_reference,transactionType:e.transaction_type}});return{statement:{account:{id:c.id,accountNumber:c.account_number,accountType:c.account_type_name,customerName:c.customer_name},period:{from:n,to:a},openingBalance:Math.round(100*l)/100,closingBalance:Math.round(100*(l+E-m))/100,totalDebits:Math.round(100*m)/100,totalCredits:Math.round(100*E)/100,entries:f},total:p}}function o(e){return new Intl.NumberFormat("en-BD",{style:"currency",currency:"BDT",minimumFractionDigits:2}).format(e)}function i(e){return new Intl.DateTimeFormat("en-GB",{day:"2-digit",month:"short",year:"numeric"}).format(new Date(e))}async function c(e,t,c){let{statement:u}=await s(e,{from:t,to:c,page:1,size:1e4}),l=await r.PDFDocument.create(),d=await l.embedFont(n.StandardFonts.Helvetica),p=await l.embedFont(n.StandardFonts.HelveticaBold),y=l.addPage([595.28,841.89]),{width:E,height:m}=y.getSize(),_=m-50,h=()=>(y=l.addPage([595.28,841.89]),_=m-50,y),f=(e,t,r,n=10,s=d,o=(0,a.rgb)(0,0,0))=>{y.drawText(e,{x:t,y:r,size:n,font:s,color:o})};(0,a.rgb)(0,0,0);let g=(0,a.rgb)(.3,.3,.3),R="BNKCORE",N=p.widthOfTextAtSize(R,22);f(R,(E-N)/2,_,22,p),_-=25;let x="Core Banking System",v=d.widthOfTextAtSize(x,10);f(x,(E-v)/2,_,10,d),_-=35;let C="Account Statement",T=p.widthOfTextAtSize(C,16);f(C,(E-T)/2,_,16,p);let O=_-=45;f("Account Holder:",50,_,10,p),f(u.account.customerName,140,_,10,d),f("Account Number:",50,_-=18,10,p),f(u.account.accountNumber,140,_,10,d),f("Account Type:",50,_-=18,10,p),f(u.account.accountType,140,_,10,d),f("Statement Period:",320,O,10,p),f(`${i(new Date(t))} - ${i(new Date(c))}`,410,O,10,d),f("Generated:",320,O-18,10,p),f(i(new Date),410,O-18,10,d),_-=50,y.drawRectangle({x:50,y:_-55,width:E-100,height:65,borderColor:(0,a.rgb)(0,0,0),borderWidth:1});let w=_-20,A=_-45;f("Opening Balance:",65,w,10,p),f(o(u.openingBalance),160,w,10,p),f("Total Credits:",310,w,10,p),f(o(u.totalCredits),400,w,10,p),f("Closing Balance:",65,A,10,p),f(o(u.closingBalance),160,A,10,p),f("Total Debits:",310,A,10,p),f(o(u.totalDebits),400,A,10,p);let S=e=>{y.drawRectangle({x:50,y:e-18,width:E-100,height:25,color:(0,a.rgb)(.9,.9,.9)});let t=e-3;f("Date",55,t,9,p),f("Description",125,t,9,p);let r=(e,t,r,n,a=9,s=p)=>{let o=s.widthOfTextAtSize(e,a);f(e,t+r-o-5,n,a,s)};r("Debit",300,70,t),r("Credit",380,70,t),r("Balance",465,80,t)};S(_-=90),_-=30;let b=(e,t,r,n,a=8,s=d)=>{let o=s.widthOfTextAtSize(e,a);f(e,t+r-o-5,n,a,s)};for(let e of(f(i(new Date(t)),55,_,8,p),f("Opening Balance",125,_,8,p),b(o(u.openingBalance),465,80,_,8,p),_-=18,u.entries)){_<110&&(h(),S(_),_-=30),u.entries.indexOf(e)%2==1&&y.drawRectangle({x:50,y:_-5,width:E-100,height:18,color:(0,a.rgb)(.98,.98,.98)}),f(i(e.date),55,_,8,d,g);let t=e.description||e.transactionType;f(t.length>35?t.substring(0,32)+"...":t,125,_,8,d),e.debit&&b(o(e.debit),300,70,_,8,d),e.credit&&b(o(e.credit),380,70,_,8,d),b(o(e.runningBalance),465,80,_,8,d),_-=18}_<90&&(h(),S(_),_-=30),_-=5,f(i(new Date(c)),55,_,8,p),f("Closing Balance",125,_,8,p),b(o(u.closingBalance),465,80,_,8,p);let D=l.getPages();for(let e=0;e<D.length;e++){let t=D[e],r=`Page ${e+1} of ${D.length} | This is a computer-generated document and does not require signature.`,n=d.widthOfTextAtSize(r,8);t.drawText(r,{x:(E-n)/2,y:30,size:8,font:d,color:(0,a.rgb)(0,0,0)})}let I=await l.save();return Buffer.from(I)}async function u(e){let{from:r,to:n,amountMin:a,amountMax:s,entryType:o,transactionType:i,reference:c,accountId:u,includeReversals:l=!0,page:d=1,size:p=50}=e,y=["1=1"],E=[];r&&(y.push("le.entry_date >= ?"),E.push(r)),n&&(y.push("le.entry_date <= ?"),E.push(n)),void 0!==a&&(y.push("le.amount >= ?"),E.push(a)),void 0!==s&&(y.push("le.amount <= ?"),E.push(s)),o&&(y.push("le.entry_type = ?"),E.push(o)),i&&(y.push("tt.code = ?"),E.push(i)),c&&(y.push("(t.transaction_reference LIKE ? OR le.description LIKE ?)"),E.push(`%${c}%`,`%${c}%`)),u&&(y.push("le.account_id = ?"),E.push(u)),l||y.push("t.status != 'REVERSED'");let m=y.join(" AND "),_=await (0,t.queryOne)(`SELECT COUNT(*) as count
         FROM ledger_entries le
         JOIN transactions t ON le.transaction_id = t.id
         JOIN transaction_types tt ON t.transaction_type_id = tt.id
         JOIN accounts a ON le.account_id = a.id
         WHERE ${m}`,E);return{results:(await (0,t.query)(`SELECT le.id, t.transaction_reference, tt.code as transaction_type,
                le.account_id, a.account_number, le.entry_type, le.amount,
                le.balance_after, le.description, le.entry_date, le.created_at,
                (t.status = 'REVERSED') as is_reversal
         FROM ledger_entries le
         JOIN transactions t ON le.transaction_id = t.id
         JOIN transaction_types tt ON t.transaction_type_id = tt.id
         JOIN accounts a ON le.account_id = a.id
         WHERE ${m}
         ORDER BY le.created_at DESC, le.id DESC
         LIMIT ? OFFSET ?`,[...E,p,(d-1)*p])).map(e=>({id:e.id,transactionReference:e.transaction_reference,transactionType:e.transaction_type,accountId:e.account_id,accountNumber:e.account_number,entryType:e.entry_type,amount:parseFloat(e.amount),balanceAfter:parseFloat(e.balance_after),description:e.description,entryDate:e.entry_date,createdAt:e.created_at,isReversal:!!e.is_reversal})),total:_?.count||0}}function l(e){return["ID,Date,Transaction Ref,Type,Account Number,Entry Type,Amount,Balance After,Description,Is Reversal",...e.map(e=>[e.id,i(e.entryDate),e.transactionReference,e.transactionType,e.accountNumber,e.entryType,e.amount.toFixed(2),e.balanceAfter.toFixed(2),`"${(e.description||"").replace(/"/g,'""')}"`,e.isReversal?"Yes":"No"]).map(e=>e.join(","))].join("\n")}e.s(["generateCsvFromResults",()=>l,"generateStatementPdf",()=>c,"getAccountStatement",()=>s,"searchTransactions",()=>u])},7806,e=>{"use strict";var t=e.i(2961),r=e.i(99823),n=e.i(20478),a=e.i(30188),s=e.i(64717),o=e.i(22511),i=e.i(86406),c=e.i(82039),u=e.i(85794),l=e.i(97655),d=e.i(16847),p=e.i(5777),y=e.i(19298),E=e.i(73225),m=e.i(2380),_=e.i(93695);e.i(99970);var h=e.i(26738),f=e.i(1265),g=e.i(74129),R=e.i(11585);let N=(0,g.withErrorHandler)(async e=>(0,g.withAuth)(e,async t=>{let{searchParams:r}=new URL(e.url),n={from:r.get("from")||void 0,to:r.get("to")||void 0,amountMin:r.get("amountMin")?parseFloat(r.get("amountMin")):void 0,amountMax:r.get("amountMax")?parseFloat(r.get("amountMax")):void 0,entryType:r.get("entryType"),transactionType:r.get("transactionType")||void 0,reference:r.get("reference")||void 0,accountId:r.get("accountId")?parseInt(r.get("accountId")):void 0,includeReversals:"false"!==r.get("includeReversals"),page:parseInt(r.get("page")||"1"),size:Math.min(parseInt(r.get("size")||"50"),100)};if("csv"===r.get("export")){let{results:e}=await (0,R.searchTransactions)({...n,page:1,size:1e4}),t=(0,R.generateCsvFromResults)(e);return new f.NextResponse(t,{status:200,headers:{"Content-Type":"text/csv","Content-Disposition":`attachment; filename="transactions_${new Date().toISOString().split("T")[0]}.csv"`}})}let{results:a,total:s}=await (0,R.searchTransactions)(n);return(0,g.successResponse)(a,(0,g.getPaginationMeta)(n.page,n.size,s))},{requiredRoles:["BANKER","ADMIN"]}));e.s(["GET",0,N],27153);var x=e.i(27153);let v=new t.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/v1/transactions/search/route",pathname:"/api/v1/transactions/search",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/src/app/api/v1/transactions/search/route.ts",nextConfigOutput:"",userland:x}),{workAsyncStorage:C,workUnitAsyncStorage:T,serverHooks:O}=v;function w(){return(0,n.patchFetch)({workAsyncStorage:C,workUnitAsyncStorage:T})}async function A(e,t,n){v.isDev&&(0,a.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let f="/api/v1/transactions/search/route";f=f.replace(/\/index$/,"")||"/";let g=await v.prepare(e,t,{srcPage:f,multiZoneDraftMode:!1});if(!g)return t.statusCode=400,t.end("Bad Request"),null==n.waitUntil||n.waitUntil.call(n,Promise.resolve()),null;let{buildId:R,params:N,nextConfig:x,parsedUrl:C,isDraftMode:T,prerenderManifest:O,routerServerContext:w,isOnDemandRevalidate:A,revalidateOnlyGenerated:S,resolvedPathname:b,clientReferenceManifest:D,serverActionsManifest:I}=g,F=(0,i.normalizeAppPath)(f),M=!!(O.dynamicRoutes[F]||O.routes[b]),H=async()=>((null==w?void 0:w.render404)?await w.render404(e,t,C,!1):t.end("This page could not be found"),null);if(M&&!T){let e=!!O.routes[b],t=O.dynamicRoutes[F];if(t&&!1===t.fallback&&!e){if(x.experimental.adapterPath)return await H();throw new _.NoFallbackError}}let q=null;!M||v.isDev||T||(q="/index"===(q=b)?"/":q);let B=!0===v.isDev||!M,P=M&&!B;I&&D&&(0,o.setManifestsSingleton)({page:f,clientReferenceManifest:D,serverActionsManifest:I});let L=e.method||"GET",j=(0,s.getTracer)(),k=j.getActiveScopeSpan(),U={params:N,prerenderManifest:O,renderOpts:{experimental:{authInterrupts:!!x.experimental.authInterrupts},cacheComponents:!!x.cacheComponents,supportsDynamicResponse:B,incrementalCache:(0,a.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:x.cacheLife,waitUntil:n.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,n,a)=>v.onRequestError(e,t,n,a,w)},sharedContext:{buildId:R}},W=new c.NodeNextRequest(e),$=new c.NodeNextResponse(t),z=u.NextRequestAdapter.fromNodeNextRequest(W,(0,u.signalFromNodeResponse)(t));try{let o=async e=>v.handle(z,U).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=j.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==l.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let n=r.get("next.route");if(n){let t=`${L} ${n}`;e.setAttributes({"next.route":n,"http.route":n,"next.span_name":t}),e.updateName(t)}else e.updateName(`${L} ${f}`)}),i=!!(0,a.getRequestMeta)(e,"minimalMode"),c=async a=>{var s,c;let u=async({previousCacheEntry:r})=>{try{if(!i&&A&&S&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let s=await o(a);e.fetchMetrics=U.renderOpts.fetchMetrics;let c=U.renderOpts.pendingWaitUntil;c&&n.waitUntil&&(n.waitUntil(c),c=void 0);let u=U.renderOpts.collectedTags;if(!M)return await (0,p.sendResponse)(W,$,s,U.renderOpts.pendingWaitUntil),null;{let e=await s.blob(),t=(0,y.toNodeOutgoingHttpHeaders)(s.headers);u&&(t[m.NEXT_CACHE_TAGS_HEADER]=u),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==U.renderOpts.collectedRevalidate&&!(U.renderOpts.collectedRevalidate>=m.INFINITE_CACHE)&&U.renderOpts.collectedRevalidate,n=void 0===U.renderOpts.collectedExpire||U.renderOpts.collectedExpire>=m.INFINITE_CACHE?void 0:U.renderOpts.collectedExpire;return{value:{kind:h.CachedRouteKind.APP_ROUTE,status:s.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:n}}}}catch(t){throw(null==r?void 0:r.isStale)&&await v.onRequestError(e,t,{routerKind:"App Router",routePath:f,routeType:"route",revalidateReason:(0,d.getRevalidateReason)({isStaticGeneration:P,isOnDemandRevalidate:A})},!1,w),t}},l=await v.handleResponse({req:e,nextConfig:x,cacheKey:q,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:O,isRoutePPREnabled:!1,isOnDemandRevalidate:A,revalidateOnlyGenerated:S,responseGenerator:u,waitUntil:n.waitUntil,isMinimalMode:i});if(!M)return null;if((null==l||null==(s=l.value)?void 0:s.kind)!==h.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==l||null==(c=l.value)?void 0:c.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});i||t.setHeader("x-nextjs-cache",A?"REVALIDATED":l.isMiss?"MISS":l.isStale?"STALE":"HIT"),T&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let _=(0,y.fromNodeOutgoingHttpHeaders)(l.value.headers);return i&&M||_.delete(m.NEXT_CACHE_TAGS_HEADER),!l.cacheControl||t.getHeader("Cache-Control")||_.get("Cache-Control")||_.set("Cache-Control",(0,E.getCacheControlHeader)(l.cacheControl)),await (0,p.sendResponse)(W,$,new Response(l.value.body,{headers:_,status:l.value.status||200})),null};k?await c(k):await j.withPropagatedContext(e.headers,()=>j.trace(l.BaseServerSpan.handleRequest,{spanName:`${L} ${f}`,kind:s.SpanKind.SERVER,attributes:{"http.method":L,"http.target":e.url}},c))}catch(t){if(t instanceof _.NoFallbackError||await v.onRequestError(e,t,{routerKind:"App Router",routePath:F,routeType:"route",revalidateReason:(0,d.getRevalidateReason)({isStaticGeneration:P,isOnDemandRevalidate:A})},!1,w),M)throw t;return await (0,p.sendResponse)(W,$,new Response(null,{status:500})),null}}e.s(["handler",()=>A,"patchFetch",()=>w,"routeModule",()=>v,"serverHooks",()=>O,"workAsyncStorage",()=>C,"workUnitAsyncStorage",()=>T],7806)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__59aeadb4._.js.map