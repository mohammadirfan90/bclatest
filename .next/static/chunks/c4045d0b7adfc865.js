(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,55448,e=>{"use strict";var s=e.i(43992),r=e.i(39436),t=e.i(48916),a=e.i(97903),i=e.i(77673),n=e.i(73236);let l=n.z.object({password:n.z.string().regex(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[^A-Za-z\d]).{8,}$/,"Password must be 8+ chars, include uppercase, lowercase, number, and special char."),confirmPassword:n.z.string()}).refine(e=>e.password===e.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]});function d(){let e=(0,t.useParams)(),n=(0,t.useRouter)(),[d,o]=(0,r.useState)(null),[c,m]=(0,r.useState)(!0),[x,u]=(0,r.useState)(!1),[p,h]=(0,r.useState)(null),[g,f]=(0,r.useState)(!1),{register:b,handleSubmit:w,formState:{errors:y}}=(0,a.useForm)({resolver:(0,i.zodResolver)(l)});(0,r.useEffect)(()=>{let s=async()=>{try{(await fetch(`/api/v1/auth/signup-tokens/${e.token}`)).ok?o(!0):(o(!1),h("Invalid or expired signup link."))}catch(e){o(!1),h("Failed to validate link.")}finally{m(!1)}};e.token&&s()},[e.token]);let j=async s=>{u(!0),h(null);try{let r=await fetch("/api/v1/auth/signup/complete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e.token,password:s.password})}),t=await r.json();if(!r.ok)throw Error(t.error||"Signup failed");f(!0),setTimeout(()=>{n.push("/login")},3e3)}catch(e){h(e.message)}finally{u(!1)}};return c?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"}),(0,s.jsx)("p",{className:"mt-4 text-gray-600",children:"Validating Key..."})]})}):d?g?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,s.jsxs)("div",{className:"bg-white p-8 rounded-lg shadow-md max-w-md w-full text-center",children:[(0,s.jsx)("div",{className:"text-green-500 text-5xl mb-4",children:"✅"}),(0,s.jsx)("h1",{className:"text-xl font-bold text-gray-900 mb-2",children:"Signup Complete"}),(0,s.jsxs)("p",{className:"text-gray-600 mb-6",children:["Your password has been set. Your account is now ",(0,s.jsx)("strong",{children:"PENDING APPROVAL"}),". You will be notified once a banker activates your access."]}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Redirecting to login..."})]})}):(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[(0,s.jsxs)("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[(0,s.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Complete Account Setup"}),(0,s.jsx)("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Set your secure password to activate your banking access."})]}),(0,s.jsx)("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:(0,s.jsx)("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10",children:(0,s.jsxs)("form",{className:"space-y-6",onSubmit:w(j),children:[p&&(0,s.jsx)("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 mb-4",children:(0,s.jsx)("div",{className:"flex",children:(0,s.jsx)("div",{className:"ml-3",children:(0,s.jsx)("p",{className:"text-sm text-red-700",children:p})})})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"New Password"}),(0,s.jsxs)("div",{className:"mt-1",children:[(0,s.jsx)("input",{id:"password",type:"password",...b("password"),className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm"}),y.password&&(0,s.jsx)("p",{className:"mt-2 text-sm text-red-600",children:y.password.message})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700",children:"Confirm Password"}),(0,s.jsxs)("div",{className:"mt-1",children:[(0,s.jsx)("input",{id:"confirmPassword",type:"password",...b("confirmPassword"),className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm"}),y.confirmPassword&&(0,s.jsx)("p",{className:"mt-2 text-sm text-red-600",children:y.confirmPassword.message})]})]}),(0,s.jsx)("div",{children:(0,s.jsx)("button",{type:"submit",disabled:x,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50",children:x?"Setting Password...":"Activate Account"})})]})})})]}):(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,s.jsxs)("div",{className:"bg-white p-8 rounded-lg shadow-md max-w-md w-full text-center",children:[(0,s.jsx)("div",{className:"text-red-500 text-5xl mb-4",children:"⚠️"}),(0,s.jsx)("h1",{className:"text-xl font-bold text-gray-900 mb-2",children:"Invalid Link"}),(0,s.jsx)("p",{className:"text-gray-600 mb-6",children:p||"This signup link is invalid, expired, or has already been used."}),(0,s.jsx)("button",{onClick:()=>n.push("/login"),className:"text-primary-600 hover:underline",children:"Return to Login"})]})})}e.s(["default",()=>d])}]);